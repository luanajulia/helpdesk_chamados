{% extends "home.html" %}

{% block body %}
{% for chamado in chamados %}

<body>
    <main>
      <div>
        <div style="margin: 20px; width: 500px;">
          {% if nivel == 'Tecnico' %}
        <h1>Editar Chamado</h1>
        {% endif %}
        {% if nivel == 'Administrador' %}
        <h1>Editar Chamado</h1>
        {% endif %}
        {% if nivel == 'usuario' %}
        <h1>Descrição Chamado</h1>
        {% endif %}
          <form method='post' action='{{url_for("edit_chamados",id=chamado.id)}}' >
            <div class='form-group'>
            <label class="form-label">Tipo de suporte:</label>
            <input type='text'  name='tipo' required class='form-control' value='{{chamado.tipo}}'  readonly>
            </div>
            <div class='form-group'>
              <label class="label">Nome de Usuario:</label>
              <input type='text' name='username' required class='form-control' value='{{chamado.username}}'  readonly>
            </div>
            <div class='form-group'>
                <label class="label" >Departamento:</label>
                <input type='text' name='departamento'  required class='form-control' value='{{chamado.departamento}}'  readonly>
              </div>
            <div class='form-group'>
              <label class="label" style="left: 104px;">E-mail:</label>
              <input type='text' name='email'  required class='form-control' value='{{chamado.email}}'  readonly>
            </div>
            <label class="label" >status:</label><br>
                  <select class="form-select" id="autoSizingSelect" name='status' value="{{chamado.status }}">
                    <option value="{{chamado.status }}" >{{chamado.status }}</option>
                    <option value="novo">Novo</option>
                    <option value="atribuido">Atribuido</option>
                    <option value="fechado">Fechado</option>
                  </select>
                <br>
                  <select class="form-select"  id="autoSizingSelect" name='atribuido' value="{{chamado.atribuido }}">
                    {% if chamado.atribuido  %}
                    <option selected value="{{chamado.atribuido }}" >{{chamado.atribuido }}</option>
                    {% else %}
                    <option selected value="{{chamado.atribuido }}" >Atribuido a quem</option>
                    {% endif %}
                    {% if current_user.nivel == 'Tecnico' %}
                    <option >{{ current_user.username }}</option>
                    {% else %}
                    {% for usuario in usuario%}
                    {% if usuario.nivel ==  'Tecnico' %}
                    <option >{{ usuario.username }}</option>
                    {% else %}
                    {% if usuario.nivel ==  'Administrador' %}
                    <option >{{ usuario.username }}</option>
                    {% endif %}
                    {% endif %}
                    {% endfor %}
                    {% endif %}
                  </select>
                  <script type="text/javascript">
                    var select = document.getElementById('autoSizingSelect');
                    select.onchange = function () {
                        select.className = this.options[this.selectedIndex].className;
                    }
                    </script>
                    <br>
            <div class='form-group'>
                <label class="label">Descrição - {{chamado.username}}</label>
                <div class='form-control'   type='text' name='descricao'   rows="5" cols="35" value='{{ chamados.descricao }}' readonly >{{ chamado.descricao }}</div>
              </div>
              <br>
              {% if chamados.status == 'fechado' %}   
                <div class='form-group'>
                <label    class="label">{{chamado.tecnico}}</label>
                  <div  class='form-control'  type='text' placeholder="Enviar uma Resolução" name='feedback'     rows="5" cols="35" value='{{ chamado.feedback }}' >{{ chamado.feedback }}</div>
                </div>
                {% else %}
                <div class="form-group" >
                  <textarea type='text' placeholder="Enviar uma Resolução" name='feedback'  class='form-control'   rows="5" cols="35" value='{{ chamado.feedback }}'> {% if chamado.feedback == None %} {% else %} {{ chamado.feedback }} {% endif %}</textarea>
                </div>
              <br>
              {% if nivel == 'Tecnico' %}
            <div class='form-group'>
            <button type='submit' value='Submit' class='btn btn-primary'>Enviar</button>
          </div>
          {% endif %}
          {% if nivel == 'Administrador' %}
          <div class='form-group'>
          <button type='submit' value='Submit' class='btn btn-primary'>Enviar</button>
        </div>
        {% endif %}
                {% endif %}
        </div>
          </form>
        </div>
      </div>
      {% endfor %}
     
{% endblock %}